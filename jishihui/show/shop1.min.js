"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Goods=exports.Goods=function(){function e(t){_classCallCheck(this,e),this.cont=t.cont,this.url=t.url,this.ajaxGet=t.method.ajaxGet,this.getCookie=t.method.getCookie,this.setCookie=t.method.setCookie,this.load(),this.addEvent()}return _createClass(e,[{key:"load",value:function(){var e=this;this.ajaxGet(this.url).then(function(t){e.res=JSON.parse(t),e.display()})}},{key:"display",value:function(){var e="";this.res.forEach(function(t){e+='<li index ="'+t.goodsId+'">\n\t\t\t\t\t<img src="'+t.src+'" />\n\t\t\t\t\t<p>加入购物车</p>\n\t\t\t\t    </li>'}),this.cont.innerHTML=e}},{key:"addEvent",value:function(){var o=this;this.cont.addEventListener("click",function(t){var e=t||window.event,n=e.target||e.srcElement;"P"==n.nodeName&&(o.id=n.parentNode.getAttribute("index"),o.setGoods())})}},{key:"setGoods",value:function(){if(this.goods=""===this.getCookie("goods")?[]:JSON.parse(this.getCookie("goods")),this.goods.length<1)this.goods.push({id:this.id,num:1});else{for(var t=!0,e=0;e<this.goods.length;e++)if(this.goods[e].id===this.id){this.goods[e].num++,t=!1;break}t&&this.goods.push({id:this.id,num:1})}this.setCookie("goods",JSON.stringify(this.goods))}}]),e}(),Car=function(){function t(){_classCallCheck(this,t),this.cont=$("#car"),this.url="../libs/data1.json",this.load(),this.addEvent()}return _createClass(t,[{key:"load",value:function(){"sucess"!=getCookie("denglu")&&(location.href="../src/index.html");var e=this;$.ajax({url:this.url,success:function(t){e.res=t,e.getCookie()}})}},{key:"getCookie",value:function(){this.goods=JSON.parse($.cookie("goods")),this.display()}},{key:"display",value:function(){for(var t="",e=0;e<this.res.length;e++)for(var n=0;n<this.goods.length;n++)this.goods[n].id===this.res[e].goodsId&&(t+='<dd data-id="'+this.res[e].goodsId+'">\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t<img src="'+this.res[e].src+'" />\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span>'+this.res[e].price+'</span>\n\t\t\t\t\t\t\t\t<p><input type="button" value="-" id ="num1"/><input type="text" value="'+this.goods[n].num+'" min=1 id ="num2"/><input type="button" value="+" id ="num"/></p>\n\t\t\t\t\t\t\t\t<span><em>删除</em></span>\n\t\t\t\t\t\t\t</dd>');this.cont.html(t)}},{key:"addEvent",value:function(){var e=this;this.cont.on("click","em",function(){e.id=$(this).parent().parent().attr("data-id"),$(this).parent().parent().remove(),e.setCookie(function(t){e.goods.splice(t,1)})}),this.cont.on("click","#num",function(){e.id=$(this).parent().parent().attr("data-id"),e.num=parseInt($(this).prev().val())+1,e.setCookie(function(t){e.goods[t].num=e.num,$("#num2").val(e.goods[t].num)})}),this.cont.on("click","#num1",function(){e.id=$(this).parent().parent().attr("data-id"),e.num=parseInt($(this).next().val())-1,e.setCookie(function(t){e.goods[t].num=$("#num2").val(),1<=e.num?$("#num2").val(e.num):$("#num2").val(1)})})}},{key:"setCookie",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(t){for(var e=0;e<this.goods.length;e++)this.goods[e].id==this.id&&t(e);setCookie("goods",JSON.stringify(this.goods))})}]),t}();exports.default={Car:Car};